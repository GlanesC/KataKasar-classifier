<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Pendeteksi Bahasa Kasar</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div class="container">
    <div class="card">
        <h1>Pendeteksi Bahasa Kasar</h1>
        <p class="subtitle">
            Sistem klasifikasi teks menggunakan Machine Learning
        </p>

        <textarea 
            id="email"
            placeholder="Masukkan kalimat atau komentar..."
            rows="4"></textarea>
        
        <div class="button-group">
            <button id="predictBtn" class="btn btn-primary">üîç Prediksi</button>
            <button id="resetBtn" class="btn btn-secondary">Reset</button>
        </div>

        <div id="result" class="result hidden">
            <span id="label" class="badge"></span>

            <div class="confidence-wrapper">
                <span>Confidence</span>
                <div class="progress">
                    <div id="confidenceBar"></div>
                </div>
                <small id="confidenceText"></small>
            </div>
        </div>
    </div>

    <footer>
        ¬© 2026 ‚Äî TUGAS BESAR BANGET
    </footer>
</div>

<script>
const predictBtn = document.getElementById("predictBtn");
const resetBtn = document.getElementById("resetBtn");
const emailInput = document.getElementById("email");
const resultDiv = document.getElementById("result");
const labelSpan = document.getElementById("label");
const confidenceBar = document.getElementById("confidenceBar");
const confidenceText = document.getElementById("confidenceText");

predictBtn.addEventListener("click", async () => {
    const email = emailInput.value.trim();
    if (!email) {
        alert("Input tidak boleh kosong!");
        return;
    }

    predictBtn.innerText = "‚è≥ Memproses...";
    predictBtn.disabled = true;

    try {
        const response = await fetch("/predict", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email })
        });

        const data = await response.json();

        resultDiv.classList.remove("hidden");

        const confidence = Math.round(data.confidence * 100);

        if (data.prediction === "kasar") {
            labelSpan.innerText = "KASAR";
            labelSpan.className = "badge badge-red";
            confidenceBar.className = "bar-red";
        } else {
            labelSpan.innerText = "NON KASAR";
            labelSpan.className = "badge badge-green";
            confidenceBar.className = "bar-green";
        }

        confidenceBar.style.width = confidence + "%";
        confidenceText.innerText = confidence + "%";
    } catch (error) {
        alert("Terjadi kesalahan saat prediksi!");
    }

    predictBtn.innerText = "üîç Prediksi";
    predictBtn.disabled = false;
});

// üîÑ RESET
resetBtn.addEventListener("click", () => {
    emailInput.value = "";
    resultDiv.classList.add("hidden");
    confidenceBar.style.width = "0%";
    confidenceText.innerText = "";
    labelSpan.innerText = "";
    emailInput.focus();
});
</script>



</body>
</html>
